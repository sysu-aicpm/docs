# 需求分析

## 项目背景

智能家居系统旨在提供一个统一的平台，让用户能够方便地管理和控制家中的各种智能设备。该系统支持多种设备类型，提供权限管理、用户分组、设备分组等功能，并通过智能助手提升用户体验。系统采用前后端分离架构，支持多种客户端访问方式，确保数据安全和隐私保护。

## 功能需求

### 用户管理
- **新用户注册**：通过账户和密码注册
- **用户登录**：通过账户和密码登录
- **管理员账户**：
  - 系统内置管理员账户
  - 管理员拥有所有设备的最高权限
  - 管理员可将普通用户升级为管理员
- **用户属性**：
  - 用户信息包括头像、邮箱、昵称、账户、密码等
  - 支持查看和修改用户信息
- **用户注销**：
  - 普通用户可以注销账户
  - 管理员可以删除普通用户
  - 管理员账户不可注销

### 权限管理
- **权限分级**：
  - 用户对设备的权限分为不可见、可见、可使用、可配置、可监视、可管理等级别
  - 不同用户对同一设备可有不同权限，同一用户对不同设备可有不同权限
  - 管理员对任何设备的权限都是"可管理"且不可修改
- **分组管理**：
  - 管理员可创建用户组和设备组
  - 支持为用户组添加/移除用户，为设备组添加/移除设备
  - 用户组和设备组支持权限分级，可查看和修改权限

### 设备管理
- **设备属性**：
  - 基本信息：IP+端口、名称、品牌型号、使用年限、设备类型等，允许修改
  - 运行信息：运行时长、功耗、状态等，根据设备类型有所不同
  - 记录信息：日志、使用记录等
- **设备操作**：
  - 管理员可添加/删除设备
  - 支持通过IP+端口添加设备
  - 支持通过局域网发现并添加设备
  - 用户可根据权限操作设备（如调整空调温度）
  - 用户可查看设备属性
- **设备监控**：
  - 记录设备日志
  - 收集设备信息（功耗、在线状态等）

### 智能助手
- 使用MCP为用户提供智能交互体验
- 支持通过聊天方式交互
- 用户不能通过智能助手执行越权行为
- 所有模型行为有清晰记录

## 非功能需求

### 兼容性
- **部署支持**：
  - Windows系统
  - Ubuntu或其他Linux系统（无需容器）
  - Docker容器
- **客户端支持**：
  - 安卓设备
  - iOS设备
  - Windows系统
  - 网页浏览器
  - Linux系统

### 可靠性
- 重要数据有备份，支持数据恢复
- 系统因环境原因停止工作后，环境恢复时能自动恢复服务
- 数据完全本地化，保护用户隐私

### 易用性
- 客户端界面设计易于使用
- 系统本地化部署简单，提供部署脚本
- 为用户提供系统使用说明

## 用户场景

### 场景一：家庭用户日常使用
普通家庭用户小张登录系统后，可以查看家中所有已授权的智能设备状态。他可以通过图形界面或与智能助手聊天的方式，调整客厅空调温度、打开卧室灯光、查看冰箱温度等。系统记录所有操作，并在设备状态异常时（如功耗过高）提醒用户。

### 场景二：家庭管理员设置
作为家庭管理员，父亲可以添加新购买的智能门锁到系统中，并为家庭成员分配不同权限。他可以创建"儿童组"用户组，将孩子的账户加入其中，并限制该组对某些设备（如门锁）的使用。

### 场景三：远程监控与控制
出差在外的用户可以通过手机应用或网页远程查看家中设备状态，如检查是否关闭电器、查看设备状态等。若发现异常，可以远程控制相关设备或通知家人处理。

### 场景四：多用户协作
一个家庭中的多个成员可以同时使用系统，各自根据权限操作不同设备。系统确保操作不冲突，并记录每个用户的操作历史，便于追溯和管理。 